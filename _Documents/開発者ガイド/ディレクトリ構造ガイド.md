# CompactSkillSheetsApp ディレクトリ構造ガイド

## 概要
本ドキュメントは、CompactSkillSheetsApp（SESスキル管理システム）のディレクトリ構造と各ディレクトリ・ファイルの役割を説明します。プロジェクトの全体像を理解し、効率的な開発を行うための参考資料です。

## ルートディレクトリ構造

```
CompactSkillSheetsApp/
├── frontend/              # フロントエンドアプリケーション
├── backend/               # バックエンドアプリケーション
├── docker/                # Docker関連設定
├── _Documents/            # プロジェクトドキュメント
├── _Features/             # 機能実装計画・仕様
├── _Knowledge/            # ナレッジベース・問題解決履歴
├── _RefactoringPlans/     # リファクタリング計画
├── _Test/                 # テスト結果・カバレッジレポート
├── _本番リリース前準備/    # 本番環境準備関連
├── CLAUDE.md              # ClaudeCode開発指針書
└── README.md              # プロジェクト概要・セットアップ手順
```

## フロントエンド構造（/frontend）

### 主要ディレクトリ

```
frontend/
├── src/
│   ├── api/               # API通信層
│   ├── assets/            # 静的リソース（画像、フォント等）
│   ├── components/        # 再利用可能なUIコンポーネント
│   ├── config/            # アプリケーション設定
│   ├── domain/            # ドメインロジック・ValueObject
│   ├── errors/            # エラー処理・カスタムエラー
│   ├── hooks/             # カスタムReact Hooks
│   ├── layouts/           # ページレイアウトコンポーネント
│   ├── lib/               # 外部ライブラリ設定・ユーティリティ
│   ├── pages/             # ページコンポーネント（ルーティング対応）
│   ├── queries/           # TanStack Query設定
│   ├── services/          # ビジネスロジックサービス
│   ├── stores/            # Zustand状態管理
│   ├── types/             # TypeScript型定義
│   ├── utils/             # ユーティリティ関数
│   └── __tests__/         # テストファイル
├── public/                # 公開静的ファイル
└── package.json           # 依存関係・スクリプト定義
```

### 重要なサブディレクトリ

#### /frontend/src/api/
API通信を管理するモジュール群。各機能別にディレクトリが分かれています。

- `approaches/` - アプローチ管理API
- `client/` - クライアント関連API
- `common/` - 共通API処理
- `email/` - メール送信API
- `engineers/` - エンジニア管理API
- `projects/` - プロジェクト管理API
- `ses/` - SES企業管理API

#### /frontend/src/components/
再利用可能なUIコンポーネント。機能別に整理されています。

- `auth/` - 認証関連コンポーネント
- `BusinessPartner/` - ビジネスパートナー管理
- `common/` - 共通コンポーネント
- `EngineerSearch/` - エンジニア検索
- `ErrorBoundary/` - エラーハンドリング
- `form/` - フォームコンポーネント
- `guards/` - ルートガード・権限制御
- `layout/` - レイアウト部品
- `partners/` - パートナー管理
- `projects/` - プロジェクト管理

#### /frontend/src/pages/
ルーティングに対応したページコンポーネント。

- `Approaches/` - アプローチ管理ページ
- `auth/` - ログイン・認証ページ
- `BusinessPartners/` - ビジネスパートナー管理ページ
- `Client/` - クライアント向けページ
  - `EngineerSearch/` - エンジニア検索
  - `OfferBoard/` - オファーボード
  - `OfferHistory/` - オファー履歴
  - `OfferManagement/` - オファー管理
- `Dashboard/` - ダッシュボード
- `Engineers/` - エンジニア管理ページ
- `engineer/` - エンジニア向けページ
- `Profile/` - プロフィール管理
- `Projects/` - プロジェクト管理ページ

#### /frontend/src/domain/
ドメイン駆動設計に基づくビジネスロジック層。

- `valueObjects/` - ValueObjectパターンの実装
  - 型安全性を保証する値オブジェクト
  - バリデーションロジックを内包

#### /frontend/src/stores/
Zustandを使用した状態管理。

- `types/` - ストア型定義
- `factories/` - ストア生成ファクトリー
- `__tests__/` - ストアのテスト

## バックエンド構造（/backend）

### 主要ディレクトリ

```
backend/
├── src/
│   ├── config/            # 設定ファイル（DB、認証等）
│   ├── controllers/       # APIコントローラー
│   ├── domain/            # ドメインモデル
│   ├── errors/            # カスタムエラークラス
│   ├── lib/               # ライブラリ・外部連携
│   ├── middleware/        # Express ミドルウェア
│   ├── models/            # データモデル（未使用・Prisma使用）
│   ├── repositories/      # データアクセス層
│   ├── routes/            # APIルーティング定義
│   ├── services/          # ビジネスロジックサービス
│   ├── types/             # TypeScript型定義
│   ├── utils/             # ユーティリティ関数
│   ├── validators/        # 入力検証（Yup）
│   └── __tests__/         # テストファイル
├── prisma/                # Prismaスキーマ・マイグレーション
├── scripts/               # 運用スクリプト
├── Logs/                  # アプリケーションログ
├── dist/                  # ビルド成果物
└── package.json           # 依存関係・スクリプト定義
```

### 重要なサブディレクトリ

#### /backend/src/controllers/
APIエンドポイントのコントローラー。各機能別にファイルが分かれています。

- 認証系: `authController.ts`, `clientAuthController.ts`, `engineerAuthController.ts`
- 管理系: `approachesController.ts`, `clientController.ts`, `engineerController.ts`
- オファー系: `offerController.ts`, `offerBoardController.ts`
- その他: `businessPartnerController.ts`, `projectController.ts`, `emailController.ts`

#### /backend/src/middleware/
Express ミドルウェア。認証、エラーハンドリング、ロギング等を担当。

- `auth/` - 認証ミドルウェア（JWT検証等）
- `errorHandler.ts` - グローバルエラーハンドリング
- `logger.ts` - ロギング設定（Winston）
- `rateLimiter.ts` - レート制限
- `validation.ts` - リクエスト検証

#### /backend/src/repositories/
データアクセス層。Prismaを使用したDB操作を抽象化。

- 各エンティティごとにリポジトリファイルが存在
- CRUD操作とカスタムクエリを提供

#### /backend/src/services/
ビジネスロジックを実装するサービス層。

- `auth/` - 認証・認可サービス
- `email/` - メール送信サービス
- その他各機能のビジネスロジック

#### /backend/prisma/
データベーススキーマとマイグレーション管理。

- `schema.prisma` - データベーススキーマ定義
- `migrations/` - マイグレーション履歴
- `seed/` - シードデータ

## ドキュメント構造（/_Documents）

プロジェクトの仕様書・設計書を管理。

```
_Documents/
├── 基本設計書/            # システム基本設計
├── 要件定義書/            # 機能要件・非機能要件
├── 実装環境・デプロイメント設計書/  # インフラ・デプロイ設計
├── MVP機能/              # MVP機能仕様
├── API設計書/            # API仕様書
├── 画面設計書/           # UI/UX設計
├── データベース設計/      # DB設計・ER図
├── 開発者ガイド/         # 開発者向けガイドライン
└── 詳細設計書/           # 詳細実装仕様
```

### 各ドキュメントの役割

- **基本設計書**: システムアーキテクチャ、技術選定、全体構成
- **要件定義書**: ビジネス要件、機能要件、非機能要件の定義
- **API設計書**: RESTful API仕様、エンドポイント定義、リクエスト/レスポンス形式
- **画面設計書**: 画面遷移、レイアウト、UIコンポーネント仕様
- **データベース設計**: テーブル定義、リレーション、インデックス設計
- **開発者ガイド**: コーディング規約、開発フロー、権限管理等のガイドライン

## その他の重要ディレクトリ

### /_Features/
機能実装の計画と仕様を管理。

- 新機能の実装計画
- バグ修正履歴（`Bug/`）
- ChatGPT質問用プロンプト（`Bug/Prompt/`）

### /_Knowledge/
開発中に発生した問題と解決方法のナレッジベース。

- エラー対処法
- 技術的な解決策
- ベストプラクティス

### /_RefactoringPlans/
リファクタリング計画と実施結果。

- リファクタリング計画書
- 実施結果レポート
- セルフレビュー記録

### /_Test/
テスト結果とカバレッジレポート。

- `CoverageReports/` - テストカバレッジ分析
- 各PR毎のテスト結果

### /docker/
Docker関連の設定ファイル。

- `docker-compose.yml` - 開発環境構成
- 各サービスのDockerfile

## 開発フロー

1. **仕様確認**: `_Documents`で仕様を確認
2. **実装計画**: `_Features`に実装計画を作成
3. **開発**: `frontend/src`と`backend/src`で実装
4. **テスト**: `__tests__`でテストを作成・実行
5. **問題解決**: 発生した問題は`_Knowledge`に記録
6. **リファクタリング**: 必要に応じて`_RefactoringPlans`に計画を作成

## 環境別の考慮事項

本プロジェクトは同一PC上で複数の環境が稼働することを前提としています。

- **開発環境**: Dockerコンテナで構築
- **Dev2環境**: 別ポートで稼働する検証環境
- **本番環境**: 本番用の設定とビルド

各環境の設定は以下のファイルで管理：
- `.env.development` - 開発環境設定
- `.env.dev2` - Dev2環境設定
- `.env.production` - 本番環境設定

## まとめ

このディレクトリ構造は、以下の原則に基づいて設計されています：

1. **関心の分離**: フロントエンド/バックエンド/ドキュメントを明確に分離
2. **機能別整理**: 各機能ごとにディレクトリを分けて管理
3. **DDD準拠**: ドメイン駆動設計の原則に従った構造
4. **保守性重視**: ドキュメントとナレッジの充実による保守性向上
5. **テスト駆動**: 各モジュールに対応するテストディレクトリ配置

開発者は、この構造を理解し、適切なディレクトリに適切なコードを配置することで、保守性と拡張性の高いシステム開発を実現できます。