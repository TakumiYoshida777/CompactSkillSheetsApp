# リクエスト・レスポンス仕様書 - エンジニアスキルシート管理システム

## 1. 共通仕様

### 1.1 リクエストヘッダー
```http
Authorization: Bearer {jwt-token}
Content-Type: application/json; charset=utf-8
Accept: application/json
X-Company-ID: {uuid-company-id}
X-Request-ID: {uuid-request-id}
X-Client-Version: v1.0.0
User-Agent: EngineerSkillsheet-Client/1.0.0
Accept-Language: ja-JP,ja;q=0.9
```

### 1.2 共通レスポンス形式
```json
{
  "success": true,
  "data": {
    // レスポンスデータ
  },
  "message": "処理が完了しました",
  "meta": {
    "timestamp": "2024-01-15T10:30:00Z",
    "requestId": "req_123456789",
    "version": "v1.0.0",
    "processingTime": 150
  }
}
```

### 1.3 エラーレスポンス形式
```json
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "入力値にエラーがあります",
    "details": [
      {
        "field": "email",
        "message": "有効なメールアドレスを入力してください",
        "value": "invalid-email",
        "location": "body"
      }
    ]
  },
  "meta": {
    "timestamp": "2024-01-01T00:00:00Z",
    "requestId": "req_123456789",
    "documentation": "https://docs.engineer-skillsheet.com/errors/VAL_001"
  }
}
```

## 2. 認証系API

### 2.1 ユーザー登録

#### リクエスト
```http
POST /auth/register
Content-Type: application/json
```

```json
{
  "name": "田中太郎",
  "email": "tanaka@company.com",
  "personalEmail": "tanaka.personal@gmail.com",
  "password": "SecurePassword123!",
  "phone": "03-1234-5678",
  "companyId": "company_123",
  "invitationToken": "inv_abc123",
  "agreedToTerms": true
}
```

#### バリデーションルール
| フィールド | 必須 | 型 | 制約 |
|------------|------|-----|------|
| name | ○ | string | 1-100文字 |
| email | ○ | string | 有効なメールアドレス |
| password | ○ | string | 12文字以上、英数字記号含む |
| phone | × | string | 日本の電話番号形式 |
| companyId | ○ | string | UUID形式 |
| agreedToTerms | ○ | boolean | true必須 |

#### 成功レスポンス（201 Created）
```json
{
  "success": true,
  "data": {
    "user": {
      "id": "user_456",
      "name": "田中太郎",
      "email": "tanaka@company.com",
      "companyId": "company_123",
      "roles": [
        {
          "id": "role_001",
          "name": "engineer",
          "displayName": "エンジニア"
        }
      ],
      "isActive": true,
      "emailVerified": false,
      "createdAt": "2024-01-01T00:00:00Z"
    },
    "tokens": {
      "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
      "refreshToken": "rt_abc123def456",
      "expiresAt": "2024-01-02T00:00:00Z",
      "tokenType": "Bearer"
    }
  },
  "message": "ユーザー登録が完了しました"
}
```

### 2.2 ログイン

#### リクエスト
```http
POST /auth/login
Content-Type: application/json
```

```json
{
  "email": "tanaka@company.com",
  "password": "SecurePassword123!",
  "rememberMe": false,
  "mfaToken": "123456"
}
```

#### 成功レスポンス（200 OK）
```json
{
  "success": true,
  "data": {
    "user": {
      "id": "user_456",
      "name": "田中太郎",
      "email": "tanaka@company.com",
      "companyId": "company_123",
      "roles": ["engineer", "sales"],
      "permissions": [
        "engineer.read",
        "engineer.create",
        "skillsheet.update"
      ],
      "lastLoginAt": "2024-01-01T09:30:00Z",
      "company": {
        "id": "company_123",
        "name": "株式会社サンプル",
        "companyType": "ses",
        "isActive": true
      }
    },
    "tokens": {
      "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
      "refreshToken": "rt_abc123def456",
      "expiresAt": "2024-01-02T00:00:00Z"
    },
    "sessionInfo": {
      "ipAddress": "192.168.1.1",
      "userAgent": "Mozilla/5.0...",
      "loginMethod": "password",
      "mfaUsed": true
    }
  },
  "message": "ログインしました"
}
```

#### MFA要求レスポンス（202 Accepted）
```json
{
  "success": false,
  "error": {
    "code": "MFA_REQUIRED",
    "message": "多要素認証が必要です",
    "details": {
      "methods": ["totp", "sms"],
      "tempToken": "temp_mfa_token_123"
    }
  }
}
```

## 3. エンジニア管理API

### 3.1 エンジニア一覧取得

#### リクエスト
```http
GET /engineers?page=1&limit=20&status=waiting&skills=JavaScript,React&sortBy=availableDate&sortOrder=asc
```

#### クエリパラメータ仕様
| パラメータ | 型 | デフォルト | 説明 |
|------------|-----|-----------|------|
| page | integer | 1 | ページ番号（1以上） |
| limit | integer | 20 | 件数制限（1-100） |
| status | string | - | working/waiting/waiting_soon |
| skills | string | - | スキル（カンマ区切り） |
| availableFrom | string | - | 稼働可能日開始（YYYY-MM-DD） |
| availableTo | string | - | 稼働可能日終了（YYYY-MM-DD） |
| experienceYears | string | - | 経験年数範囲（例：3-5） |
| sortBy | string | createdAt | ソート項目 |
| sortOrder | string | desc | asc/desc |

#### 成功レスポンス（200 OK）
```json
{
  "success": true,
  "data": [
    {
      "id": "eng_123",
      "name": "田中太郎",
      "email": "tanaka@company.com",
      "currentStatus": "waiting",
      "engineerType": "employee",
      "availableDate": "2024-02-01",
      "totalExperienceYears": 5,
      "skills": {
        "programmingLanguages": [
          {
            "name": "JavaScript",
            "level": 4,
            "experienceYears": 5
          }
        ],
        "frameworks": [
          {
            "name": "React",
            "level": 4,
            "experienceYears": 3
          }
        ]
      },
      "nearestStation": "新宿駅",
      "isPublic": true,
      "profileImage": {
        "id": "img_123",
        "url": "https://cdn.example.com/profiles/user1.jpg",
        "thumbnailUrl": "https://cdn.example.com/profiles/user1_thumb.jpg"
      },
      "currentProject": {
        "id": "proj_456",
        "name": "ECサイト開発",
        "plannedEndDate": "2024-01-31"
      },
      "createdAt": "2024-01-01T00:00:00Z",
      "updatedAt": "2024-01-15T10:30:00Z"
    }
  ],
  "meta": {
    "pagination": {
      "page": 1,
      "limit": 20,
      "total": 150,
      "totalPages": 8,
      "hasNext": true,
      "hasPrev": false,
      "nextPage": 2,
      "prevPage": null
    },
    "aggregations": {
      "statusCount": {
        "working": 85,
        "waiting": 15,
        "waiting_soon": 8
      },
      "skillsCount": {
        "JavaScript": 45,
        "Python": 28,
        "Java": 32,
        "React": 38
      },
      "experienceRanges": {
        "0-2": 25,
        "3-5": 45,
        "6-10": 55,
        "11+": 25
      }
    },
    "sort": {
      "field": "availableDate",
      "order": "asc"
    }
  }
}
```

### 3.2 エンジニア詳細取得

#### リクエスト
```http
GET /engineers/eng_123
```

#### 成功レスポンス（200 OK）
```json
{
  "success": true,
  "data": {
    "id": "eng_123",
    "name": "田中太郎",
    "nameKana": "タナカタロウ",
    "email": "tanaka@company.com",
    "phone": "03-1234-5678",
    "birthDate": "1990-01-01",
    "gender": "male",
    "nearestStation": "新宿駅",
    "githubUrl": "https://github.com/tanaka",
    "engineerType": "employee",
    "currentStatus": "waiting",
    "availableDate": "2024-02-01",
    "isPublic": true,
    "profileImage": {
      "id": "img_123",
      "url": "https://cdn.example.com/profiles/user1.jpg",
      "thumbnailUrl": "https://cdn.example.com/profiles/user1_thumb.jpg"
    },
    "companyId": "company_123",
    "userId": "user_456",
    
    "skillSheet": {
      "id": "skill_789",
      "summary": "フルスタックエンジニアとして5年間のWebアプリケーション開発経験を持ちます。特にReact/Node.jsを用いたSPAの開発が得意で、AWS上での運用経験も豊富です。",
      "totalExperienceYears": 5,
      "programmingLanguages": [
        {
          "name": "JavaScript",
          "level": 4,
          "experienceYears": 5,
          "description": "ES6+、TypeScriptでの開発経験"
        },
        {
          "name": "TypeScript",
          "level": 3,
          "experienceYears": 2,
          "description": "型安全な開発、大規模プロジェクトでの使用経験"
        }
      ],
      "frameworks": [
        {
          "name": "React",
          "level": 4,
          "experienceYears": 3,
          "description": "Hooks、Context API、Redux使用経験"
        },
        {
          "name": "Vue.js",
          "level": 3,
          "experienceYears": 1,
          "description": "Vue3、Composition API使用経験"
        }
      ],
      "databases": [
        {
          "name": "PostgreSQL",
          "level": 3,
          "experienceYears": 3,
          "description": "設計・最適化・運用経験"
        },
        {
          "name": "MongoDB",
          "level": 2,
          "experienceYears": 1,
          "description": "基本的なCRUD操作とスキーマ設計"
        }
      ],
      "cloudServices": [
        {
          "name": "AWS",
          "level": 3,
          "experienceYears": 2,
          "services": ["EC2", "RDS", "S3", "CloudFront", "Lambda"]
        }
      ],
      "tools": [
        "Git", "Docker", "VSCode", "Webpack", "ESLint", "Jest"
      ],
      "certifications": [
        {
          "name": "AWS Solutions Architect Associate",
          "acquiredDate": "2023-06-01",
          "expiryDate": "2026-06-01",
          "credentialId": "AWS-SAA-123456"
        }
      ],
      "possibleRoles": ["PG", "PL"],
      "possiblePhases": [
        "要件定義", "基本設計", "詳細設計", 
        "実装・開発", "テスト", "保守・運用"
      ],
      "educationBackground": [
        {
          "schoolName": "東京大学",
          "degree": "学士",
          "field": "情報工学",
          "graduationYear": 2018
        }
      ],
      "careerSummary": "新卒でSIerに入社し、Webアプリケーション開発に従事。その後、スタートアップでフルスタックエンジニアとして経験を積み、現在に至る。",
      "specialSkills": "アジャイル開発経験、チームリード経験、新人教育経験",
      "isCompleted": true,
      "lastUpdatedAt": "2024-01-10T14:30:00Z",
      "lastUpdatedBy": "user_456"
    },
    
    "currentProject": {
      "id": "proj_456",
      "name": "ECサイト開発",
      "clientCompany": "株式会社サンプル",
      "role": "フロントエンドエンジニア",
      "startDate": "2023-10-01",
      "plannedEndDate": "2024-01-31",
      "technologies": ["React", "TypeScript", "AWS"],
      "teamSize": 8,
      "responsibilities": [
        "フロントエンド設計・開発",
        "UIコンポーネント作成",
        "API連携実装"
      ]
    },
    
    "projectHistory": [
      {
        "id": "proj_456",
        "name": "ECサイト開発",
        "clientCompany": "株式会社サンプル",
        "role": "フロントエンドエンジニア",
        "startDate": "2023-10-01",
        "endDate": null,
        "isCurrent": true,
        "technologies": ["React", "TypeScript"],
        "achievements": [
          "レスポンシブデザインの実装",
          "パフォーマンス最適化により読み込み速度30%向上"
        ]
      },
      {
        "id": "proj_789",
        "name": "社内システム改修",
        "clientCompany": "内部プロジェクト",
        "role": "フルスタックエンジニア",
        "startDate": "2023-04-01",
        "endDate": "2023-09-30",
        "isCurrent": false,
        "technologies": ["Vue.js", "Node.js", "PostgreSQL"],
        "achievements": [
          "レガシーシステムのモダン化",
          "API設計・実装"
        ]
      }
    ],
    
    "statistics": {
      "totalProjects": 8,
      "averageProjectDuration": "6ヶ月",
      "skillUpdateFrequency": "月1回",
      "approachReceived": 12,
      "matchingScore": 85
    },
    
    "createdAt": "2024-01-01T00:00:00Z",
    "updatedAt": "2024-01-15T10:30:00Z"
  },
  "message": "エンジニア詳細を取得しました"
}
```

### 3.3 エンジニア作成

#### リクエスト
```http
POST /engineers
Content-Type: application/json
```

```json
{
  "name": "佐藤花子",
  "nameKana": "サトウハナコ",
  "email": "sato@company.com",
  "phone": "03-1234-5679",
  "birthDate": "1995-05-15",
  "gender": "female",
  "nearestStation": "渋谷駅",
  "githubUrl": "https://github.com/sato",
  "engineerType": "employee",
  "availableDate": "2024-03-01",
  "isPublic": true
}
```

#### バリデーションルール
| フィールド | 必須 | 型 | 制約 |
|------------|------|-----|------|
| name | ○ | string | 1-100文字 |
| email | ○ | string | 有効なメールアドレス、企業内重複不可 |
| phone | × | string | 日本の電話番号形式 |
| birthDate | × | string | YYYY-MM-DD形式、18歳以上 |
| gender | × | enum | male/female/other |
| engineerType | ○ | enum | employee/freelance |
| availableDate | × | string | YYYY-MM-DD形式、未来日 |

#### 成功レスポンス（201 Created）
```json
{
  "success": true,
  "data": {
    "id": "eng_789",
    "name": "佐藤花子",
    "email": "sato@company.com",
    "engineerType": "employee",
    "currentStatus": "working",
    "isPublic": true,
    "profileImage": null,
    "skillSheet": {
      "id": "skill_101",
      "isCompleted": false
    },
    "createdAt": "2024-01-15T10:30:00Z"
  },
  "message": "エンジニアが作成されました"
}
```

## 4. スキルシート管理API

### 4.1 スキルシート更新

#### リクエスト
```http
PUT /engineers/eng_123/skill-sheet
Content-Type: application/json
```

```json
{
  "summary": "5年間のWebアプリケーション開発経験を持つフルスタックエンジニア。React/Node.jsを用いた開発が得意で、チームリードの経験もあります。",
  "totalExperienceYears": 5,
  "programmingLanguages": [
    {
      "name": "JavaScript",
      "level": 4,
      "experienceYears": 5,
      "description": "ES6+、非同期処理、モジュール化"
    },
    {
      "name": "TypeScript",
      "level": 3,
      "experienceYears": 2,
      "description": "型安全な開発、大規模プロジェクトでの使用"
    }
  ],
  "frameworks": [
    {
      "name": "React",
      "level": 4,
      "experienceYears": 3,
      "description": "Hooks、Context、Redux使用経験"
    }
  ],
  "databases": [
    {
      "name": "PostgreSQL",
      "level": 3,
      "experienceYears": 3,
      "description": "設計・最適化・運用"
    }
  ],
  "cloudServices": [
    {
      "name": "AWS",
      "level": 3,
      "experienceYears": 2,
      "services": ["EC2", "RDS", "S3", "Lambda"]
    }
  ],
  "tools": ["Git", "Docker", "VSCode", "Webpack"],
  "certifications": [
    {
      "name": "AWS Solutions Architect Associate",
      "acquiredDate": "2023-06-01",
      "expiryDate": "2026-06-01",
      "credentialId": "AWS-SAA-123456"
    }
  ],
  "possibleRoles": ["PG", "PL"],
  "possiblePhases": [
    "要件定義", "基本設計", "詳細設計", 
    "実装・開発", "テスト"
  ],
  "educationBackground": [
    {
      "schoolName": "東京大学",
      "degree": "学士",
      "field": "情報工学",
      "graduationYear": 2018
    }
  ],
  "careerSummary": "新卒でSIerに入社後、Webアプリケーション開発に従事。スタートアップでフルスタック開発を経験。",
  "specialSkills": "チームリーダー経験、アジャイル開発、新人指導",
  "isCompleted": true
}
```

#### 成功レスポンス（200 OK）
```json
{
  "success": true,
  "data": {
    "id": "skill_789",
    "engineerId": "eng_123",
    "summary": "5年間のWebアプリケーション開発経験...",
    "isCompleted": true,
    "completionRate": 100,
    "lastUpdatedAt": "2024-01-15T10:30:00Z",
    "lastUpdatedBy": "user_456",
    "validationResults": {
      "hasErrors": false,
      "warnings": [],
      "suggestions": [
        "最新の技術トレンドを追加してみませんか？",
        "プロジェクト成果をより具体的に記述することをお勧めします"
      ]
    }
  },
  "message": "スキルシートが更新されました"
}
```

## 5. 検索API

### 5.1 エンジニア検索

#### リクエスト
```http
POST /search/engineers
Content-Type: application/json
```

```json
{
  "filters": {
    "skills": {
      "programmingLanguages": ["JavaScript", "TypeScript"],
      "frameworks": ["React", "Vue.js"],
      "databases": ["PostgreSQL"],
      "requiredLevel": 3
    },
    "experienceYears": {
      "min": 3,
      "max": 10
    },
    "status": ["waiting", "waiting_soon"],
    "availableDate": {
      "from": "2024-02-01",
      "to": "2024-06-30"
    },
    "roles": ["PG", "PL"],
    "phases": ["development", "testing"],
    "location": {
      "stations": ["新宿駅", "渋谷駅"],
      "prefectures": ["東京都"]
    },
    "engineerType": ["employee", "freelance"],
    "certifications": ["AWS"],
    "projectExperience": {
      "industries": ["EC", "金融"],
      "projectScale": ["medium", "large"]
    }
  },
  "sort": {
    "field": "experienceYears",
    "order": "desc"
  },
  "pagination": {
    "page": 1,
    "limit": 20
  },
  "options": {
    "includeSkillDetails": true,
    "includeProjectHistory": false,
    "calculateMatchScore": true
  }
}
```

#### 成功レスポンス（200 OK）
```json
{
  "success": true,
  "data": [
    {
      "id": "eng_123",
      "name": "田中太郎",
      "skills": {
        "programmingLanguages": [
          {
            "name": "JavaScript",
            "level": 4,
            "experienceYears": 5,
            "matched": true
          },
          {
            "name": "TypeScript",
            "level": 3,
            "experienceYears": 2,
            "matched": true
          }
        ],
        "frameworks": [
          {
            "name": "React",
            "level": 4,
            "experienceYears": 3,
            "matched": true
          }
        ]
      },
      "totalExperienceYears": 5,
      "currentStatus": "waiting",
      "availableDate": "2024-02-01",
      "possibleRoles": ["PG", "PL"],
      "nearestStation": "新宿駅",
      "engineerType": "employee",
      "matchScore": 85,
      "matchDetails": {
        "skillsMatch": 90,
        "experienceMatch": 80,
        "availabilityMatch": 100,
        "locationMatch": 70
      },
      "highlightedSkills": ["JavaScript", "React", "TypeScript"],
      "profileImage": {
        "thumbnailUrl": "https://cdn.example.com/profiles/user1_thumb.jpg"
      }
    }
  ],
  "meta": {
    "pagination": {
      "page": 1,
      "limit": 20,
      "total": 42,
      "totalPages": 3,
      "hasNext": true,
      "hasPrev": false
    },
    "searchInfo": {
      "searchId": "search_abc123",
      "executionTime": 150,
      "appliedFilters": {
        "skills": 3,
        "experience": 1,
        "status": 2,
        "location": 2
      }
    },
    "aggregations": {
      "skillsCount": {
        "JavaScript": 35,
        "TypeScript": 28,
        "React": 25,
        "Vue.js": 15
      },
      "experienceRanges": {
        "3-5": 18,
        "6-8": 15,
        "9-10": 9
      },
      "statusCount": {
        "waiting": 25,
        "waiting_soon": 17
      },
      "locationCount": {
        "新宿駅": 20,
        "渋谷駅": 15,
        "池袋駅": 7
      }
    },
    "suggestions": {
      "relatedSkills": ["Vue.js", "Angular", "Next.js"],
      "alternativeSearches": [
        "React + Node.js",
        "TypeScript + Express"
      ],
      "recommendedFilters": [
        {
          "type": "certification",
          "value": "AWS",
          "reason": "検索結果の60%が保有"
        }
      ]
    }
  },
  "message": "42件のエンジニアが見つかりました"
}
```

## 6. アプローチ管理API

### 6.1 アプローチ送信

#### リクエスト
```http
POST /approaches
Content-Type: application/json
```

```json
{
  "approachType": "manual",
  "targetType": "company",
  "targetId": "company_456",
  "targetEngineers": ["eng_123", "eng_456"],
  "contactMethods": ["email", "phone"],
  "priority": "high",
  "projectDetails": {
    "name": "新規ECサイト開発プロジェクト",
    "description": "React/Node.jsを使用した大規模ECサイトの新規開発。アジャイル開発手法を採用し、6ヶ月間のプロジェクトです。",
    "requirements": [
      "React/TypeScript 3年以上の経験",
      "アジャイル開発経験",
      "チームでの開発経験"
    ],
    "startDate": "2024-04-01",
    "duration": "6ヶ月",
    "location": "東京都新宿区（リモート可）",
    "workStyle": "hybrid",
    "budget": {
      "min": 600000,
      "max": 800000,
      "unit": "monthly"
    }
  },
  "messageContent": "いつもお世話になっております。新規ECサイト開発プロジェクトでReact/TypeScriptのスキルをお持ちのエンジニアを募集しており、貴社のエンジニアの方々にぜひご参画をご検討いただきたくご連絡いたします。",
  "emailTemplateId": "template_123",
  "customFields": {
    "urgency": "高",
    "clientCompany": "大手EC企業"
  },
  "scheduledSendAt": null,
  "followUpSettings": {
    "enabled": true,
    "followUpDays": 7,
    "maxFollowUps": 2
  }
}
```

#### 成功レスポンス（201 Created）
```json
{
  "success": true,
  "data": {
    "id": "approach_789",
    "approachType": "manual",
    "targetType": "company",
    "targetCompany": {
      "id": "company_456",
      "name": "株式会社取引先"
    },
    "targetEngineers": [
      {
        "id": "eng_123",
        "name": "田中太郎"
      },
      {
        "id": "eng_456", 
        "name": "佐藤花子"
      }
    ],
    "status": "sent",
    "sentAt": "2024-01-15T10:30:00Z",
    "sentBy": {
      "id": "user_789",
      "name": "営業担当者"
    },
    "deliveryInfo": {
      "email": {
        "status": "delivered",
        "deliveredAt": "2024-01-15T10:31:30Z",
        "recipients": ["contact@partner-company.com"]
      }
    },
    "tracking": {
      "trackingId": "track_abc123",
      "openTrackingEnabled": true,
      "linkTrackingEnabled": true
    },
    "followUp": {
      "nextFollowUpAt": "2024-01-22T10:30:00Z",
      "followUpCount": 0
    },
    "createdAt": "2024-01-15T10:30:00Z"
  },
  "message": "アプローチを送信しました"
}
```

## 7. 管理者API

### 7.1 企業管理

#### 企業作成リクエスト
```http
POST /admin/companies
Content-Type: application/json
```

```json
{
  "name": "株式会社新規SES",
  "companyType": "ses",
  "emailDomain": "new-ses.com",
  "address": {
    "postalCode": "100-0001",
    "prefecture": "東京都",
    "city": "千代田区",
    "addressLine": "千代田1-1-1",
    "building": "サンプルビル10F"
  },
  "phone": "03-1234-5678",
  "websiteUrl": "https://www.new-ses.com",
  "contactEmail": "contact@new-ses.com",
  "maxEngineers": 100,
  "contractPlan": "standard",
  "representative": {
    "name": "代表太郎",
    "email": "ceo@new-ses.com",
    "phone": "03-1234-5670"
  },
  "billing": {
    "companyName": "株式会社新規SES",
    "department": "経理部",
    "contactPerson": "経理花子",
    "email": "accounting@new-ses.com",
    "phone": "03-1234-5671"
  },
  "initialUsers": [
    {
      "name": "管理者太郎",
      "email": "admin@new-ses.com",
      "roles": ["admin"]
    }
  ]
}
```

#### 成功レスポンス（201 Created）
```json
{
  "success": true,
  "data": {
    "id": "company_999",
    "name": "株式会社新規SES",
    "companyType": "ses",
    "emailDomain": "new-ses.com",
    "isActive": true,
    "maxEngineers": 100,
    "currentEngineers": 0,
    "currentUsers": 1,
    "contractInfo": {
      "planId": "plan_standard",
      "planName": "スタンダードプラン",
      "contractStatus": "active",
      "startDate": "2024-01-15",
      "billingCycle": "monthly"
    },
    "setupInfo": {
      "setupCompleted": false,
      "remainingSteps": [
        "initial_user_setup",
        "email_verification",
        "payment_method_setup"
      ],
      "setupToken": "setup_token_abc123"
    },
    "createdAt": "2024-01-15T10:30:00Z",
    "createdBy": "admin_user_123"
  },
  "message": "企業が作成されました"
}
```

### 7.2 利用統計取得

#### リクエスト
```http
GET /admin/usage/statistics?period=month&companyId=company_123&includeDetails=true
```

#### 成功レスポンス（200 OK）
```json
{
  "success": true,
  "data": {
    "period": {
      "type": "month",
      "start": "2024-01-01T00:00:00Z",
      "end": "2024-01-31T23:59:59Z"
    },
    "company": {
      "id": "company_123",
      "name": "株式会社サンプル",
      "contractPlan": "standard"
    },
    "usage": {
      "users": {
        "total": 25,
        "active": 20,
        "newRegistrations": 3,
        "averageLoginFrequency": 15.5
      },
      "engineers": {
        "total": 85,
        "active": 70,
        "withCompletedSkillSheet": 65,
        "publicEngineers": 60
      },
      "projects": {
        "total": 12,
        "active": 8,
        "completed": 4
      },
      "approaches": {
        "sent": 45,
        "received": 12,
        "successRate": 26.7
      },
      "storage": {
        "used": 1250,
        "limit": 5000,
        "unit": "MB"
      },
      "api": {
        "totalCalls": 12500,
        "averageResponseTime": 150,
        "errorRate": 0.02
      }
    },
    "trends": {
      "userGrowth": 12.5,
      "engineerGrowth": 8.3,
      "approachGrowth": -5.2
    },
    "comparison": {
      "previousPeriod": {
        "users": 22,
        "engineers": 78,
        "approaches": 47
      },
      "industryAverage": {
        "approachSuccessRate": 22.1,
        "skillSheetCompletionRate": 68.5
      }
    },
    "alerts": [
      {
        "type": "warning",
        "message": "ストレージ使用率が制限の25%に達しています",
        "threshold": 1250,
        "current": 1250
      }
    ]
  },
  "message": "利用統計を取得しました"
}
```

## 8. バリデーションエラーの詳細例

### 8.1 複合バリデーションエラー
```json
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "入力値に複数のエラーがあります",
    "details": [
      {
        "field": "email",
        "message": "既に登録されているメールアドレスです",
        "value": "existing@company.com",
        "location": "body",
        "code": "DUPLICATE_EMAIL"
      },
      {
        "field": "password",
        "message": "パスワードは12文字以上で、英字・数字・記号を含む必要があります",
        "value": "[REDACTED]",
        "location": "body",
        "code": "INVALID_PASSWORD_FORMAT",
        "requirements": {
          "minLength": 12,
          "requiresUppercase": true,
          "requiresLowercase": true,
          "requiresNumbers": true,
          "requiresSymbols": true
        }
      },
      {
        "field": "birthDate",
        "message": "18歳以上である必要があります",
        "value": "2010-01-01",
        "location": "body",
        "code": "AGE_REQUIREMENT_NOT_MET"
      }
    ]
  },
  "meta": {
    "timestamp": "2024-01-01T00:00:00Z",
    "requestId": "req_validation_error_123"
  }
}
```

## 9. 大量データ処理API

### 9.1 一括エクスポート

#### リクエスト
```http
POST /export/engineers
Content-Type: application/json
```

```json
{
  "format": "excel",
  "filters": {
    "status": ["waiting", "waiting_soon"],
    "skills": ["JavaScript", "React"],
    "includeSkillSheet": true
  },
  "fields": [
    "name", "email", "skills", "currentStatus", 
    "availableDate", "totalExperienceYears"
  ],
  "options": {
    "includeHeaders": true,
    "dateFormat": "YYYY-MM-DD",
    "encoding": "utf-8"
  },
  "delivery": {
    "method": "download",
    "notifyEmail": "admin@company.com"
  }
}
```

#### 非同期処理レスポンス（202 Accepted）
```json
{
  "success": true,
  "data": {
    "jobId": "export_job_abc123",
    "status": "processing",
    "progress": 0,
    "estimatedTime": 180,
    "resultUrl": null,
    "createdAt": "2024-01-15T10:30:00Z",
    "expiresAt": "2024-01-16T10:30:00Z"
  },
  "message": "エクスポート処理を開始しました"
}
```

#### ジョブ状況確認
```http
GET /export/jobs/export_job_abc123
```

#### 完了時レスポンス（200 OK）
```json
{
  "success": true,
  "data": {
    "jobId": "export_job_abc123",
    "status": "completed",
    "progress": 100,
    "resultUrl": "https://cdn.example.com/exports/engineers_20240115.xlsx",
    "fileInfo": {
      "filename": "engineers_20240115.xlsx",
      "size": 2048576,
      "recordCount": 150,
      "checksumSHA256": "abc123def456..."
    },
    "completedAt": "2024-01-15T10:33:25Z",
    "expiresAt": "2024-01-16T10:30:00Z"
  },
  "message": "エクスポートが完了しました"
}
```

このリクエスト・レスポンス仕様書により、開発者はAPIの正確な使用方法と期待される動作を理解し、効率的な実装が可能になります。