# admin_rolesテーブル分析レポート

## 現状

### データ状態
- `admin_roles`: 0件（空）
- `admin_users`: 0件（空）
- `admin_user_roles`: 0件（空）

### テーブル構造分析

#### admin_rolesテーブル
```sql
- id: bigint (PK)
- name: varchar(50) UNIQUE
- displayName: varchar(100)
- description: text
- permissions: jsonb  -- JSONBで権限を直接保存
- isSystem: boolean
- createdAt/updatedAt: timestamp
```

#### 関連テーブル
- `admin_users` - 管理者専用ユーザーテーブル
- `admin_user_roles` - 管理者ユーザーとロールの中間テーブル

## 分析結果

### 1. 設計意図の推測

このテーブル群は、以下の2つの可能性が考えられます：

#### 可能性1: 旧設計の残骸
- 初期設計では管理者用に別テーブルを用意
- 後に統一的なRBACシステム（roles/permissions）に移行
- 移行後、これらのテーブルは使用されなくなった

#### 可能性2: 将来の拡張用
- スーパー管理者向けの特別な権限管理
- システム全体の管理者（SaaS管理者）用
- テナント管理者とは別の権限体系

### 2. 現在の権限システムとの関係

#### 現在使用中の権限システム
```
users ← user_roles → roles ← role_permissions → permissions
```

#### admin_rolesシステム（未使用）
```
admin_users ← admin_user_roles → admin_roles (JSONBで権限保存)
```

### 3. 主な違い

| 項目 | 現在のシステム | admin_rolesシステム |
|------|---------------|-------------------|
| 権限の保存方法 | 正規化（別テーブル） | JSONB（直接保存） |
| ユーザーテーブル | users | admin_users |
| 柔軟性 | 高（権限の組み合わせ自由） | 低（事前定義のロール） |
| パフォーマンス | JOINが必要 | 高速（JSONBクエリ） |

## 判定と推奨事項

### 判定: 🟡 現時点では不要だが、削除は保留

### 理由
1. **現在のRBACシステムで十分**
   - admin権限を持つユーザーは`users`テーブルで管理
   - `roles`テーブルにadminロールが存在
   - 権限の細かい制御が可能

2. **将来の拡張可能性**
   - マルチテナントSaaS化の際に有用かもしれない
   - システム管理者とテナント管理者の分離

3. **リスク**
   - 削除による予期せぬ影響の可能性
   - 設計意図が不明確

### 推奨アクション

#### 短期（現在）
```sql
-- 何もしない（データ投入不要）
-- 現在のRBACシステムを継続使用
```

#### 中期（1-3ヶ月）
1. 設計ドキュメントの確認
2. 使用箇所の完全な調査
3. 不要と判断できれば削除検討

#### 長期（将来）
マルチテナント化の際に再評価：
- テナント管理者: `users` + `roles`
- システム管理者: `admin_users` + `admin_roles`

## 結論

`admin_roles`テーブル群は現在使用されておらず、データ投入は不要です。現在実装したRBACシステム（`roles`/`permissions`）で全ての権限管理要件を満たしています。

ただし、これらのテーブルは将来の拡張や異なる権限体系の実装に備えて残しておくことを推奨します。

## 対応の必要性

**緊急度**: 低
**重要度**: 低
**アクション**: 不要（現状維持）