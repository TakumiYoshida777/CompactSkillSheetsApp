# ClaudeCode対応 SESスキル管理システム 開発指針書

## 作成日時
作成日: 2025年8月3日  
更新者: AI システム整理  
バージョン: 1.0

---
# **重要な制約**
- **必須**必ずserenaと協力して作業をすること
- **必須**必ずCompactSkillSheetsApp/_Documentsディレクトリの中のファイル群を理解してから思考すること
- **必須**推測は禁止です。推測が必要な場合、_Documentsディレクトリを改めて全て理解した後、指示者に質問してください
- **必須**決してuuidを使用しないこと
- **必須**絶対にuuidは使用しないこと
- **必須**uuidはこの世から消し去られたものと理解し、使っても意味がないことを認識すること
- **必須**暫定対応はしないこと
- **必須**一時的な対応はしないこと
- **必須**常に本番環境で使える実装をすること
- **必須**全ての行動の前に_Knowledgeディレクトリを読み込んでから行動すること
- **必須**認証機能の実装は「_Documents/開発ガイド/認証実装ガイドライン.md」に従うこと
- **必須**重複したコンテナが存在したら、「重複したコンテナが存在します。起動しているコンテナをクローズしてください」と指示者に伝えること

# ChatGPTに質問
- 「ChatGPTに質問に質問してください」と指示があった場合_Features/Promptディレクトリにマークダウン形式で質問プロンプトを記載すること
  - プロンプトの冒頭に「AIが誤解しない粒度で回答してください」と記載すること



## 1. 基本方針

### 1.1 言語・地域設定
- **使用言語**: 日本語（すべての対話・実装・ドキュメント）
- **対象地域**: 日本
- **多言語対応**: 不要

### 1.2 プロジェクト理解の前提条件
- 作業開始前に必ずプロジェクトナレッジ内の全ファイルを読み理解すること
- 特に`_Documents`ディレクトリ内のファイル群を完全に理解してから作業に取り組む
- `_Documents`内のファイルは仕様変更により随時更新される可能性がある

### 1.3 作業品質管理
- 作業完了後は必ずセルフレビューを実行
- 確認項目:
  - 不整合がないか
  - 過不足がないか
  - 要件は満たせているか
  - 致命的なミスはしていないか
  - AIが読んで誤解しない表現ができているか

---

## 2. Git・バージョン管理ルール

### 2.1 必須事項
- **Git CLI使用**: GUI ツールは使用せず、コマンドラインで操作
- **ブランチ戦略**: featureブランチは最新のdevelopブランチから作成
- **日本語での記録**: GitHubへの入力はすべて日本語で行う

### 2.2 作業フロー
1. **作業前準備**: 必ず`origin develop`ブランチをPull
2. **Issue作成**: 実装前に必ずIssueを作成しPullRequestと紐づけ
3. **ブランチ命名**: どのIssueを対応したかわかるようにする

### 2.3 PullRequest内容
#### 良いPRの特徴

- **適切なサイズ**: 1つのPRで1つの機能に集中
- **明確なコミット履歴**: 意味のある単位でコミットを分割
- **自己完結**: そのPRだけで変更内容が理解できる
- **テスト済み**: 動作確認とテストが完了している
- **再現可能**: 他の開発者が同じ手順でテストできる
- **E2Eテスト**: テストシナリオがチェックボックスで記載されている

#### 避けるべき内容

- 曖昧な説明（「修正しました」だけなど）
- 複数の無関係な変更を含む
- 大量の不要なファイル変更
- テストやドキュメントの更新漏れ
- テスト手順の記載漏れ

#### テスト手順記載のメリット

- レビュアーが効率的に動作確認できる
- QAチームがテストしやすい
- 将来のリグレッションテストに活用できる
- 新しいチームメンバーの学習に役立つ
- デプロイ前の最終確認がスムーズになる

### 2.3 マージ条件
PullRequestのマージは以下条件を満たしてから実行:
- 影響範囲へのバグの混入がない
- 要件を満たせている（仕様に沿っている）
- コード品質は良い
- PullRequestマージ前にはコードレビューを1名以上から取得
- マージ先はGitフローに従う

### 2.4 テスト要件
- **必須**: フロントエンドもバックエンドもcoverage80%以上であること
- **必須**: コミット前にフロントエンドとバックエンドのテストを実行
- **必須**: 全てのテストがグリーンであること

---

## 3. 実装・コーディングルール

### 3.1 コード品質原則
- マーチン・ファウラーの思想に沿ったリファクタリング
- ケント・ベック（Kent Beck）のテスト駆動開発（TDD）
- ボーイスカウトの法則採用
- DRY原則・YAGNI原則・SOLID原則に従う
- プリンシプル・オブ・プログラミングの思想に基づく
- リーダブルコードの思想に基づく

### 3.2 テスト要件
- **テストカバレッジ**: 80%以上をキープ
- **TDD採用**: テスト駆動開発を実践
- 新しいコンポーネント作成時は必ずテストも作成
- テスト結果は、_Testディレクトリに、PR番号とPRのタイトルをファイル名にし、マークダウンファイルで格納してください

### 3.3 コメント・ドキュメント
- コードに対するコメントは日本語で記載
- 不要なコード・console.logは削除
- 適切な命名と責務を明確に設計

---

## 4. フロントエンド開発ルール

### 4.1 技術スタック
フロントエンド
| 項目 | 技術 | 理由 |
|------|------|------|
| フレームワーク | React.js + TypeScript | 大規模開発に適用、型安全性 |
| UI ライブラリ | Ant Design | 高品質なUI コンポーネント |
| 状態管理 | Zustand | 軽量でシンプル、TypeScript親和性 |
| ルーティング | React Router | SPA の標準ルーティング |
| HTTP クライアント | TanStack Query + Axios | 高度なキャッシュ・状態管理 |
| CSS | Tailwind CSS / Styled Components | レスポンシブデザイン対応 |
| ビルドツール | Vite / Webpack | 高速ビルド |
| テスト | Jest + React Testing Library | 単体・統合テスト |


### 4.2 設計原則
- `_Documents/デザイン定義書.md`を基準に実装
- レスポンシブデザイン対応
- アクセシビリティ対応（WCAG 2.1 AA準拠）

### 4.3 データフェッチング
- TanStack Query を使用
- 参考: https://tanstack.com/query/latest/docs/framework/react/

---

```

### 5.2 技術スタック


### 5.3 コード品質ツール
```bash
# Formatting
uv run --frozen ruff format .
uv run --frozen ruff check . --fix

# Type checking
uv run --frozen pyright

# Testing
PYTEST_DISABLE_PLUGIN_AUTOLOAD="" uv run --frozen pytest
```

### 5.4 エラーハンドリング
- `logger.exception()`を使用（`logger.error()`ではない）
- 例外メッセージに例外オブジェクトを含めない
- 具体的な例外をキャッチ（`Exception`は最小限）

---

## 6. データベース設計ルール

### 6.1 設計思想
- 奥野幹也氏の思想に沿った設計
- **UUID使用禁止**: IDにUUIDは使用しない
- 常に正規化を徹底
- 保守性と可読性の高い設計
- パフォーマンスを高く保つ

### 6.2 データベース運用
- **バックアップ**: 大きい修正前はバックアップを取得
- **保存場所**: SQLファイルのバックアップは`backup`ディレクトリに格納

---

## 7. Docker・環境管理

### 7.1 Docker操作
- Dockerの操作は`README.md`を参照
- 動作確認はすべてDocker上で実行
- `npm run dev`サーバーは使用しない

### 7.2 結果確認の徹底
- Git操作後は`git status`等で状態確認
- 実装後は`curl`コマンドでアクセステスト
- 可能な限りの動作確認を実行

---

## 8. エラー対応指針
- **必須**本番で使えるコードを使って修正すること（一時対応などは絶対にしないでください）
### 8.1 調査手順
1. `CompactSkillSheetsApp/_Knowledge`ディレクトリの内容で解決可能か判断
2. `backend/logs`の最新ファイルでエラーログ確認
3. 根本的な解決方法を思考
   →クリティカルシンキングを用いる
4. 実装方針を固める（影響範囲洗い出し）

### 8.2 ドキュメント管理(ナレッジ登録)
- 問題記録: `CompactSkillSheetsApp/_Features/Bug`ディレクトリ
- 命名規則: `日付+適切なファイル名.md`
- 解決後: `CompactSkillSheetsApp/_Knowledge`ディレクトリに命名規則に沿ったファイル名で事象と根本的解決方法を記載

---

## 9. ファイル・ディレクトリ管理

### 9.1 一時ファイル
- 場所: `./tmp`ディレクトリを作成
- 冒頭に用途と使用時期を記載

### 9.2 バージョン管理
- 仕様変更時: `Old`ディレクトリに`日付+適切なファイル名.md`で変更前状態を保存
- mdファイル作成時: 必ず作成日時をファイル内容に記載

### 9.3 ディレクトリ構成
- `_Documents`: プロダクトのドキュメント類すべて
- `_Features`: 実装予定機能の計画・まとめ場所
- `_RefactoringPlans`: リファクタリング計画
- `Done`: 実装完了済み内容




### 10 設計指針
- ユーザビリティを最優先
- アクセシビリティ対応必須

---

## 11. セルフレビュー必須項目
作業完了後は以下を必ず確認:

### 11.1 技術的整合性
- [ ] 整合性は取れているか
- [ ] 致命的なミスはしていないか
- [ ] セキュリティホールはないか

### 11.2 可読性・保守性
- [ ] AIが読んでも誤解しない日本語や構成になっているか
- [ ] 命名規則に従っているか
- [ ] コメントは適切に記載されているか

### 11.3 要件適合性
- [ ] 仕様書の要件を満たしているか
- [ ] 期待される動作をしているか
- [ ] エラーハンドリングは適切か

---

## 12. 作業開始時の確認事項

### 12.1 必須確認
指示者から指示があったら、必ず以下を質問してから作業開始:
> 「Gitの状態は宜しいですか？」

指示者が「はい」と答えてから指示内容を実行する。
指示者が「いいえ」と答えたら一度処理を中断する

### 12.2 不明点への対応
- 指示が不明瞭な場合は質問する
- 選択肢が2つ以上生まれた場合は質問する
- 段階的な開発を進め、ユーザーフィードバックを取り入れながら改善する

## 13. まとめ

この指針書は、ClaudeCodeが日本人向けSESスキル管理システムを開発する際の包括的なガイドラインです。すべてのルールを遵守し、高品質なシステム開発を実現してください。

特に重要なのは：
1. **事前理解**: プロジェクトナレッジの完全理解
2. **品質確保**: Kent BeckのTDD・テストカバレッジ80%以上・セルフレビュー
3. **チーム連携**: Git運用ルール・日本語でのコミュニケーション
4. **継続的改善**: ボーイスカウトの法則・DRYの原則・ファウラーのリファクタリング

これらを遵守することで、保守性が高く、拡張性に優れたシステムを構築できます。


## 14. 本番リリース前準備
- _本番リリース前準備 ディレクトリに、本番リリース時に対応すべきことを都度マークダウンファイルで記載しておくこと